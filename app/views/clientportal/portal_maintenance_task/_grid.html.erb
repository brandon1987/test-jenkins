<div class="content-main">

    <table id="mjob-task-table">
        <thead>
            <tr>
                <%
                customfields=[]
                DesktopMaintenanceCustomField.order("tblMaintenanceCustomFields_ID DESC").all.each do |customfield|  
                    customfields<< customfield.name
                end

                fullcolumns=['MJob No','Job No','Customer','Description','Status','Priority','Priority Desc','Inception','Start','Planned Completion','Completion','Address Name','Address 1','Address 2','Address 3','Address 4','Address 5','Manager Name','Address Description','Value','Site Ref'].concat(customfields)
                forbiddencolumns=ClientportalHiddenColumns.where(:customer_id=>session[:customer_id],:section=>"is_portal_maintenancetasks").pluck(:column)
                columns=fullcolumns-forbiddencolumns
                %>
                <% columns.each do |column|%>
                    <th><%=column%></th>
                <%end%>
            </tr>
        </thead>
        <tbody>

        </tbody>
    </table>
    <script>
        fullcolumns=<%=raw fullcolumns.to_json%>;
        columns=<%=raw columns.to_json%>;
    </script>

</div>





